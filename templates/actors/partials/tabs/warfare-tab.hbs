<div class="tab flexrow" data-group="primary" data-tab="warfare">
    <section class="derived-statistics flex-7">
        <section class="command">
            <header class="header-field">
                <span>{{localize "CS.sheets.unit.warfare.command"}}</span>
            </header>
            <section class="flexrow">
                <section class="commander flex-4">
                    <header class="subheader-field">
                        <span>{{localize "CS.sheets.unit.warfare.commander"}}</span>
                    </header>
                    <ol  class="list equipment-list">
                        <li class="item flexrow">
                            <div class="commander-profile-img-container">
                                <img class="profile-list-img" src="{{character.commander.img}}" title="{{character.commander.name}}" />
                            </div>
                            <div class="commander-txt-container"><label>{{character.commander.name}}</label></div>
                        </li>
                    </ol>
                </section>
                <section class="status flex-2">
                    <header class="subheader-field">
                        <span>{{localize "CS.sheets.generalLabels.total"}}</span>
                    </header>
                    <div class="disposition-list">
                        {{#each statuses}}
                            <div class="disposition status option capitalize {{showIfEquals @index ../character.currentStatus "selected"}}" data-id="{{@index}}">
                                {{localize this.name}}
                            </div>
                        {{/each}}
                    </div>
                </section>
                <section class="discipline flex-4">
                    <header class="subheader-field">
                        <span>{{localize "CS.sheets.unit.warfare.discipline"}}</span>
                    </header>
                    <ol class="list equipment-list">
                        <li class="list-header flexrow">
                            <div class="">Base</div>
                            <div class="">Mod</div>
                            <div class="item-controls">Total</div>
                        </li>
                        <li  class="flexrow">
                            <input
                                    id="system.discipline.value"
                                    class="small-field"
                                    name="system.discipline.value"
                                    type="text"
                                    value="{{character.discipline.value}}"
                                    placeholder="0"
                                    data-dtype="Number"
                            />
                            <b>+</b>
                            <input
                                    id="system.discipline.modifier"
                                    class="small-field"
                                    name="system.discipline.modifier"
                                    type="text"
                                    value="{{character.discipline.modifier}}"
                                    placeholder="0"
                                    readonly="readonly"
                                    data-dtype="Number"
                            />
                            <b>=</b>
                            <input
                                    id="system.discipline.total"
                                    class="small-field"
                                    name="system.discipline.total"
                                    type="text"
                                    value="{{character.discipline.total}}"
                                    placeholder="0"
                                    readonly="readonly"
                                    data-dtype="Number"
                            />
                        </li>
                        <li class="list-header flexrow">
                            <div class="center flex-6">By Orders Received</div>
                            <div class="flex-2"></div>
                            <div class="flex-2"></div>
                        </li>
                        <li class="flexrow">
                            <div class="flex-6">
                                {{> (ratingCheckbox) max=character.ordersReceived.total currentValue=character.ordersReceived.current dataType="OrdersReceived" }}
                            </div>
                            <div class="flex-2"></div>
                            <div class="flex-2 white-label">{{character.discipline.totalWithOrders}}</div>
                        </li>
                    </ol>
                </section>
            </section>
        </section>
        <section class="standing-order">
            <header class="header-field">
                <span>{{localize "CS.sheets.unit.warfare.currentOrder"}}</span>
            </header>
            {{#if character.currentOrder }}
                <ol class="list equipment-list">
                    <li class="list-header flexrow">
                        <div class="flex-1">&nbsp;</div>
                        <div class="weapon-label">{{localize "CS.sheets.generalLabels.name"}}</div>
                        <div class="">{{localize "CS.sheets.unit.warfare.standingOrder"}}</div>
                    </li>
                    <li class="item flexrow" data-item-id="{{character.currentOrder._id}}">
                        <a class="item item-edit flexrow">
                            <div class="flex-1">&nbsp;</div>
                            <div class="weapon-label field">
                                <p>{{character.currentOrder.name}}</p>
                            </div>
                            <div class="weapon-label field">
                                {{enrich character.currentOrder.system.standingOrder}}
                            </div>
                        </a>
                    </li>
                </ol>
            {{/if}}
        </section>
        <section class="combat">
            <header class="header-field">
                <span>Combat</span>
            </header>
            <section class="flexrow">
                <section class="stats flex-1">
                    <header class="subheader-field">
                        <span class="form-fields">Damage Resistance</span>
                    </header>
                    <div class="center padding-1">{{character.damageResistance}}</div>
                    <header class="subheader-field">
                        <span>Defense</span>
                    </header>
                    <div class="form-group">
                        <span class="form-fields">
                            <input
                                    name="system.derivedStats.combatDefense.value"
                                    type="text"
                                    value="{{character.derivedStats.combatDefense.total}}"
                                    placeholder="Total"
                                    readonly="readonly"
                                    data-dtype="Number"
                            />
                        </span>
                    </div>
                    <table>
                        <thead>
                        <tr>
                            <th>v. Melee</th>
                            <th>v. Ranged</th>
                        </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>{{character.discreteDefenses.vFighting.total}}</td>
                                <td>{{character.discreteDefenses.vMarksmanship.total}}</td>
                            </tr>
                        </tbody>
                    </table>
                    <header class="subheader-field">
                        <span>{{localize "CS.sheets.generalLabels.custom"}} {{localize "CS.sheets.generalLabels.defense"}}</span>
                    </header>
                    <div class="center flexrow">
                        <span class="form-fields padding-3 flex-8">
                            <!--suppress HtmlFormInputWithoutLabel -->
                            <input
                                    id="system.derivedStats.combatDefense.overrideValue"
                                    name="system.derivedStats.combatDefense.overrideValue"
                                    type="text"
                                    value="{{character.derivedStats.combatDefense.overrideValue}}"
                                    placeholder="{{character.derivedStats.combatDefense.total}}"
                                    data-dtype="Number"
                            />
                        </span>
                        <a class="checkButton padding-3 flex-2 actor-flag-toggle {{showIfTrue character.derivedStats.combatDefense.override "activated" ""}}" data-item-id="{{_id}}" data-name="derivedStats.combatDefense.override" data-value="{{character.derivedStats.combatDefense.override}}" title="{{localize "CS.sheets.character.combatDefense.override"}}"><i class="fa-solid fa-toggle-on padding-3"></i></a>
                    </div>
                    <header class="subheader-field">
                        <span>Health</span>
                    </header>
                    <div class="form-group">
                        <span class="form-fields">
                            <input
                                    id="system.derivedStats.health.current"
                                    name="system.derivedStats.health.current"
                                    type="text"
                                    value="{{character.derivedStats.health.current}}"
                                    placeholder="{{character.derivedStats.health.total}}"
                                    data-dtype="Number"
                            />
                            <b> / </b>
                            <input
                                    id="system.derivedStats.health.value"
                                    name="system.derivedStats.health.value"
                                    type="text"
                                    value="{{character.derivedStats.health.total}}"
                                    placeholder="Total"
                                    readonly="readonly"
                                    data-dtype="Number"
                            />
                        </span>
                    </div>
                    <header class="subheader-field">
                        <span>Disorganisation</span>
                    </header>
                    {{> (ratingCheckbox) max=character.disorganisation.total currentValue=character.disorganisation.current dataType="Disorganisation" }}
                    <header class="subheader-field">
                        <span>Movement</span>
                    </header>
                    <table>
                        <thead>
                        <tr>
                            <th>Base</th>
                            <th>Sprint</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>{{character.movement.total}}</td>
                            <td>{{character.movement.sprintTotal}}</td>
                        </tr>
                        </tbody>
                    </table>
                </section>
                <section class="facing flex-4">
                    <header class="subheader-field">
                        <span>Facing</span>
                    </header>
                    <li class="list-header flexrow">
                        <div class="">Target</div>
                    </li>
                    <div class="disposition-list">
                        {{#each facings}}
                            <div class="disposition facing option flexrow {{showIfEquals @index ../character.currentFacing "selected"}}" data-id="{{@index}}">
                                {{localize this.name}}
                            </div>
                        {{/each}}
                    </div>
                </section>
                <section class="weapons flex-5">
                    <header class="subheader-field">
                        <span>Attacks</span>
                    </header>
                    <table>
                        <thead>
                        <tr>
                            <th>Type</th>
                            <th>Test</th>
                            <th>Damage</th>
                        </tr>
                        </thead>
                        <tbody>
                        {{#each character.owned.weapons as |weapon index|}}
                            <tr class="item weapon" data-item-id="{{_id}}">
                                <td class="weapon-label item-edit field"><a>{{weapon.name}}</a></td>
                                <td class="rollable" id="weapon-test:{{weapon.name}}:{{formulaToStr weapon.formula}}">
                                    <a>{{format-formula weapon.formula}}</a>
                                </td>
                                <td class="weapon-label item-edit field"><a>{{weapon.damageValue}}</a></td>
                            </tr>
                        {{/each}}
                        </tbody>
                    </table>
                    <header class="subheader-field">
                        <span>Armor</span>
                    </header>
                    <table>
                        <thead>
                        <tr>
                            <th>Rating</th>
                            <th>Penalty</th>
                            <th>Bulk</th>
                            <th class="item-controls"></th>
                        </tr>
                        </thead>
                        <tbody>
                        {{#each character.owned.armors as |armor index|}}
                            <tr class="item armor" data-item-id="{{_id}}">
                                <td class="item-edit"><a>{{armor.system.rating}}</a></td>
                                <td class="item-edit"><a>{{armor.system.penalty}}</a></td>
                                <td class="item-edit"><a>{{armor.system.bulk}}</a></td>
                                <td class="item-controls flexrow">
                                    <a class="checkButton equipped {{showIfEquals "1" armor.system.equipped "activated" ""}}" data-item-id="{{_id}}" data-hand="{{showIfEquals "1" armor.system.equipped 0 1}}" data-type="armor"><i class="fas fa-user"></i></a>
                                </td>
                            </tr>
                        {{/each}}
                        </tbody>
                    </table>
                    <header class="subheader-field">
                        <span>Equipment</span>
                    </header>
                    <table>
                        <thead>
                        <tr>
                            <th>Name</th>
                            <th>AR</th>
                            <th>Health/Uses</th>
                            <th>Cost</th>
                        </tr>
                        </thead>
                        <tbody>
                        {{#each character.owned.equipments as |equipment index|}}
                            <tr class="item equipment" data-item-id="{{_id}}">
                                <td class="item-edit"><a>{{equipment.name}}</a></td>
                                <td class="item-edit"><a>{{equipment.system.armorRating}}</a></td>
                                <td class="item-edit"><a>{{equipment.system.health.current}}</a></td>
                                <td class="item-edit"><a>{{equipment.system.cost}}</a></td>
                            </tr>
                        {{/each}}
                        </tbody>
                    </table>
                    <section class="heroes">
                        <header class="subheader-field">
                            <span>Attached Heroes</span>
                        </header>
                        <ol  class="list equipment-list">
                            <li class="list-header flexrow">
                                <div class="">Name</div>
                                <div class="item-controls"><i class="fas fa-cog"></i></div>
                            </li>
                            {{#each character.owned.heroes as |hero index|}}
                                <li class="item heroes flexrow" data-item-id="{{_id}}">
                                    <div class="actor-open field"><a>{{hero.name}}</a></div>
                                    <div class="item-controls">
                                        <a class="checkButton equipped {{showIfEquals "5" hero.system.equipped "activated" ""}}" data-item-id="{{_id}}" data-hand="{{showIfEquals "5" hero.system.equipped 0 5}}" data-type="hero"><i class="fas fa-star"></i></a>
                                        <a class="item-control owned-item-control" title="Delete" data-index="{{index}}" data-list="heroes" data-action="delete"><i class="fas fa-trash"></i></a>
                                    </div>
                                </li>
                            {{/each}}
                        </ol>
                    </section>
                </section>
            </section>
        </section>
    </section>
    <section class="formation flex-3">
        <header class="header-field">
            <span>{{localize "CS.sheets.unit.warfare.training"}}</span>
        </header>
        <header class="subheader-field">
            <span>{{localize (concat "CS.sheets.unit.training." character.training.current) }}</span>
        </header>
        {{> (ratingCheckbox) max=character.training.total currentValue=character.training.current dataType="Training" }}
        <header class="header-field">
            <span>{{localize "CS.sheets.unit.warfare.formation"}}</span>
        </header>
        <li class="list-header flexrow">
            <div class="flex-9">{{localize "CS.sheets.generalLabels.name"}}</div>
            <div class="center flex-1">{{localize "CS.sheets.unit.warfare.difficulty"}}</div>
        </li>
        <div class="disposition-list">
            {{#each formations}}
                <div class="disposition formation option {{showIfEquals @index ../character.currentFormation "selected"}}" data-id="{{@index}}">
                    <li class="flexrow" data-id="{{@index}}">
                        <label class="flex-9" data-id="{{@index}}">{{localize this.name}}</label>
                        <label class="center flex-1" data-id="{{@index}}">
                            {{showIfDifferent 0 this.difficulty this.difficulty : ""}}
                        </label>
                    </li>
                    <li class="flexrow" data-id="{{@index}}">
                        {{#each this.conditionalModifiers}}
                            <label class="font-small padding-3">{{this}}</label>
                        {{/each}}
                    </li>
                </div>
            {{/each}}
        </div>
    </section>
</div>
